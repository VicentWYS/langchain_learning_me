# 最佳实践

1. 获取最终答案
   final_answer = response['messages'][-1].content

2. 查看是否使用了工具
   used_tools = [
       msg.tool_calls[0]['name']
       for msg in response['messages']
       if hasattr(msg, 'tool_calls') and msg.tool_calls
   ]

3. 流式输出用于用户体验
   for chunk in agent.stream(input):
       # 实时显示给用户

4. 调试时查看完整历史
   for msg in response['messages']:
       print(msg)

5. 错误处理
   try:
       response = agent.invoke(input)
   except Exception as e:
       print(f"Agent 执行错误: {e}")

6. API 注意事项（LangChain 1.0）
   - 使用 create_agent（LangChain 1.0 新 API）
   - LangChain 1.0 新 API


# 实际示例
```
print("\n实际示例：")
system_prompt="你是一个有帮助的助手。"
agent = create_agent(model=model, tools=[calculator])

try:
   response = agent.invoke({
      "messages": [{"role": "user", "content": "5 加 3"}]
   })

   # 获取最终答案
   final_answer = response['messages'][-1].content
   print(f"最终答案: {final_answer}")

   # 查看使用的工具
   used_tools = [
      msg.tool_calls[0]['name']
      for msg in response['messages']
      if hasattr(msg, 'tool_calls') and msg.tool_calls
   ]
   print(f"使用的工具: {used_tools}")

except Exception as e:
   print(f"错误: {e}")
```